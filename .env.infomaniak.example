# =====================================================
# CONFIGURATION MEDANNOT - INFOMANIAK
# =====================================================
# Copiez ce fichier en .env et remplissez vos valeurs

# -----------------------------------------------------
# BASE DE DONNÉES POSTGRESQL (Infomaniak)
# -----------------------------------------------------
# Option A: Serveur Cloud PostgreSQL Infomaniak
DATABASE_URL=postgresql://username:password@xxxxx.postgresql.infomaniak.ch:5432/medannot

# OU Option B: PostgreSQL local sur le VPS
# DATABASE_URL=postgresql://medannot:votre_mot_de_passe@localhost:5432/medannot

# Variables individuelles (utilisées par le serveur)
PGHOST=xxxxx.postgresql.infomaniak.ch
PGPORT=5432
PGDATABASE=medannot
PGUSER=medannot_user
PGPASSWORD=votre_mot_de_passe_securise

# -----------------------------------------------------
# APPLICATION
# -----------------------------------------------------
NODE_ENV=production
PORT=3000
VITE_APP_URL=https://medannot.ch

# Clé secrète pour JWT (générez une chaîne aléatoire de 64+ caractères)
# Commande: openssl rand -base64 64
JWT_SECRET=votre_jwt_secret_tres_long_et_aleatoire_min_64_caracteres

# Clé de chiffrement pour données sensibles
ENCRYPTION_KEY=votre_cle_de_chiffrement_32_chars

# -----------------------------------------------------
# STRIPE (Configuration existante)
# -----------------------------------------------------
# PUBLISHABLE KEY (commence par pk_live_)
STRIPE_PUBLISHABLE_KEY=pk_live_YOUR_PUBLISHABLE_KEY_HERE

# SECRET KEY (commence par sk_live_)
STRIPE_SECRET_KEY=sk_live_YOUR_SECRET_KEY_HERE

# WEBHOOK SECRET (à configurer dans Stripe Dashboard)
# Endpoint: https://medannot.ch/api/webhooks/stripe
STRIPE_WEBHOOK_SECRET=whsec_YOUR_WEBHOOK_SECRET_HERE

# -----------------------------------------------------
# EMAIL - Infomaniak Mail
# -----------------------------------------------------
# SMTP Infomaniak (à configurer dans Manager)
SMTP_HOST=mail.infomaniak.com
SMTP_PORT=587
SMTP_SECURE=false
SMTP_USER=noreply@medannot.ch
SMTP_PASS=votre_mot_de_passe_email
SMTP_FROM=MedAnnot <noreply@medannot.ch>

# Email admin (pour notifications)
ADMIN_EMAIL=admin@medannot.ch

# -----------------------------------------------------
# AUTH (Supabase ou Auth maison)
# -----------------------------------------------------
# Option A: Garder Supabase Auth (cloud)
VITE_SUPABASE_URL=https://vbaaohcsmiaxbqcyfhhl.supabase.co
VITE_SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIs...
SUPABASE_SERVICE_ROLE_KEY=eyJhbGciOiJIUzI1NiIs...

# Option B: Auth complètement maison (décommentez ces lignes)
# VITE_USE_CUSTOM_AUTH=true
# VITE_API_URL=https://medannot.ch/api

# -----------------------------------------------------
# FICHIERS & STOCKAGE
# -----------------------------------------------------
# Répertoire pour uploads (annotations audio, etc.)
UPLOAD_DIR=/var/www/medannot/uploads
MAX_FILE_SIZE=10485760

# -----------------------------------------------------
# SÉCURITÉ
# ----------------------------------------------------=
# Rate limiting (requêtes par minute)
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100

# CORS (origines autorisées)
CORS_ORIGIN=https://medannot.ch,https://www.medannot.ch

# -----------------------------------------------------
# LOGGING
# -----------------------------------------------------
LOG_LEVEL=info
LOG_FILE=/var/log/medannot/app.log

# -----------------------------------------------------
# MONITORING (Optionnel)
# ----------------------------------------------------=
# Sentry pour le tracking d'erreurs
# SENTRY_DSN=https://xxxxx@xxxxx.ingest.sentry.io/xxxxx

# Health check token (pour monitoring externe)
HEALTH_CHECK_TOKEN=token_pour_uptime_kuma_ou_autre

# -----------------------------------------------------
# FONCTIONNALITÉS
# ----------------------------------------------------=
# Activer/désactiver l'inscription
ALLOW_REGISTRATION=true

# Période d'essai (jours)
TRIAL_DAYS=14

# Prix abonnement (centimes)
SUBSCRIPTION_PRICE_CENTS=14900
SUBSCRIPTION_CURRENCY=chf

# ----------------------------------------------------=
# NOTES IMPORTANTES
# ----------------------------------------------------=
# 1. Ne JAMAIS committer ce fichier (.env) dans Git
# 2. Utilisez des mots de passe forts et uniques
# 3. Changez les secrets JWT et ENCRYPTION_KEY
# 4. Gardez une copie de sauvegarde dans un gestionnaire de mots de passe
# 5. Testez en mode développement avant production

# Commande pour générer un JWT_SECRET:
# openssl rand -base64 64
#
# Commande pour tester la connexion DB:
# psql "$DATABASE_URL"
#
# Commande pour redémarrer l'app:
# sudo systemctl restart medannot
# ou
# pm2 restart medannot-api
